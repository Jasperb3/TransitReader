transits_to_natal_chart_reading_task:
  description: >
    Perform a comprehensive technical extraction of today's significant transit-to-natal interactions between current planetary positions and the subject's natal chart, providing degree-perfect, house-specific data for personalized developmental interpretation.

    **Critical Requirements**:
    - **Orb Precision**: Report ALL transit-to-natal aspect orbs numerically with two decimal places (e.g., "Transit Saturn square Natal Sun, Orb: 1.23°" NOT "tight aspect")
    - **Applying/Separating Clarity**: For each aspect, explicitly state if it is applying (tightening) or separating (widening)
    - **Data Verification**: Use QdrantSearchTool to verify interpretation of significant transits, especially outer planet-natal planet combinations
    - **Prioritization**: If many transits are active, prioritize:
        1. Transits to angles (ASC, DSC, MC, IC) with orbs <2°
        2. Outer planet transits (Saturn-Pluto) to personal planets (Sun, Moon, Mercury, Venus, Mars) with orbs <2°
        3. Planetary returns (transiting planet conjunct its natal position)
        4. Transits triggering natal configurations (completing T-squares, Grand Crosses, etc.)
        5. Other transit-to-natal aspects

    Extraction Focus:
    - Identify all major transit-to-natal aspects:
        - Prioritize conjunctions, oppositions, squares, trines, and sextiles.
        - Maintain strict tight orbs: ~2° for outer planets (Saturn–Pluto, Chiron), ~1° for inner planets (Sun–Mars).
        **MANDATORY**: For each aspect, explicitly state the exact orb measurement in this format: "Orb: X.XX°" (e.g., "Orb: 1.23°")
    - Note aspect status: indicate whether each aspect is applying or separating (e.g., "Applying, will be exact in 3 days" or "Separating, was exact 2 days ago").
    - Map each transiting planet's current position into the subject's natal house structure (Placidus system).
    - Highlight activation of natal Angles (ASC, DSC, MC, IC) and major natal planets (especially Sun, Moon, chart ruler, and stelliums).
    - Identify if transiting planets complete or trigger natal configuration patterns (e.g., forming a Grand Cross, Kite, or T-square).
    - **Planetary Returns Detection**: Flag ONLY when transiting planet conjuncts (0° ± 2°) its own natal position
        - Examples: Transit Saturn ☌ Natal Saturn = Saturn Return (state exact orb: "Orb: 0.45°")
        - Transit Jupiter ☌ Natal Jupiter = Jupiter Return
        - **Do not infer or assume returns** - only report if conjunction exists in extracted data with numerical orb
    - **Critical Cycle Detection**: Flag mid-cycle points (oppositions) and quarter-cycle points (squares) only when same-planet aspect exists
        - Example: Transit Saturn ☍ Natal Saturn = Saturn Opposition (mid-cycle)
        - Example: Transit Saturn □ Natal Saturn = Saturn Square (quarter-cycle)
    - Capture planetary dignity/debility, motion (direct/retrograde), and proximity to stationing points for each transiting body involved.

    **Research Protocol**:
    - Use QdrantSearchTool for significant outer planet transits
      - **Query Strategy**: Use SHORT, technical astrological terms ONLY (2-4 words maximum)
      - **GOOD queries**: "Saturn square Sun", "Pluto conjunct Moon", "Uranus opposition Venus", "Saturn return"
      - **BAD queries**: "Saturn square natal Sun meaning", "Pluto conjunct natal Moon psychological development", "transit Uranus opposition"
      - **Rule**: Omit words like "natal", "meaning", "transit", "interpretation" - use core planet-aspect-planet terms only
      - Integrate astrological literature insights for rare or intense transits

    Output Structure:
    - Transit-to-Natal Aspects Table:
        - Columns: Transiting Planet, Natal Planet/Point, Aspect Type, Degrees (Transit/Natal), Orb, Natal House, Transit House, Applying/Separating, Planetary Dignity/Status
    - Major Transit Activations Summary:
        - Notable angular hits, personal planet activations, stellium overlays
    - Key Returns and Critical Phases Summary (if applicable)
    - Notes on Retrograde Status and Stationary Planets (if applicable)

    Special Instructions:
    - Be strictly factual: do not interpret or infer psychological meanings at this stage.
    - Ensure precise degree accuracy and clean modular markdown formatting.

    Subject Information:
    - Name: {name}
    - Date of Birth: {date_of_birth}
    - Birth Location: {birthplace}
    - Transit Location: {transit_location}

    Transit to Natal Chart Data:
    {transit_to_natal_chart}

  expected_output: >
    A degree-accurate, house-mapped, orb-prioritized extraction of today's transit-to-natal interactions, structured cleanly in markdown, providing complete technical input for downstream developmental interpretation.
    
  agent: transits_to_natal_chart_reader

transits_to_natal_chart_interpretation_task:
  description: >
    Interpret the extracted transit-to-natal data to identify the subject’s key personal developmental themes, psychological challenges, growth opportunities, and timing arcs for the current transit cycle.

    Interpretation Focus:
    - Synthesize major transit-to-natal activations into 2–4 overarching psychological or symbolic growth themes.
    - Analyze activated natal houses and angles to map the life domains currently most influenced.
    - Interpret any planetary returns or major transit phases (if provided) in psychological and archetypal developmental context:
        - e.g., Saturn return = maturity, Uranus opposition = individuation crisis, Nodal return = destiny recalibration.
    - Prioritize:
        - Tight orbed aspects.
        - Activations involving outer planets, angles, chart rulers, personal planets, or stelliums.
        - Stationing or retrograde transiting planets influencing natal structures.
    - For each major transit activation:
        - Outline internal psychological development potentials (e.g., empowerment, emotional resilience, relational evolution).
        - Suggest probable circumstantial shifts (e.g., career restructuring, home changes, relational reevaluation) — probabilistically, not deterministically.
        - Specify timing arcs:
            - Activation onset
            - Peak intensity (especially at exact aspects or station points)
            - Resolution phase.
    - Always anchor interpretation explicitly to technical data (aspect, house, planet, dignity/motion status).

    Output Instructions:
    - Structure under clear modular headings:
        - Major Growth Themes
        - Life Domains Activated
        - Timing Windows and Critical Peaks
    - Embed verified technical anchor points naturally into the psychological narrative.
    - Maintain an emotionally intelligent, empowering, psychologically sophisticated tone.
    - Write in clean, modular markdown without code blocks or meta-commentary.

    Subject Information:
    - Name: {name}
    - Date of Birth: {date_of_birth}
    - Birth Location: {birthplace}
    - Transit Location: {transit_location}

  expected_output: >
    A richly layered, technically anchored, psychologically empowering interpretation of the subject's active transit-to-natal themes, structured in clean markdown for seamless downstream integration into the final report.
    
  agent: transits_to_natal_chart_interpreter